%% IEEE-118 bus system
nbus = 118;
Sbase = 100; %% MVA
wb = 2*pi*50; %% rad/s

%%      |  From_Bus |  T_ Bus  |   R_pu    |   X_pu     |     B_pu
branch_data=[
                0         1      0.03030    0.09990    0.02117
                0         2      0.01290    0.04240    0.00902
                3         4      0.00176    0.00798    0.00175
                2         4      0.02410    0.10800    0.02367
                4         5      0.01190    0.05400    0.01188
                5         6      0.00459    0.02080    0.00458
                7         8      0.00244    0.03050    0.96833
                8         9      0.00258    0.03220    1.02500
                3        10      0.02090    0.06880    0.01457
                4        10      0.02030    0.06820    0.01448
               10        11      0.00595    0.01960    0.00418
                1        11      0.01870    0.06160    0.01310
                2        11      0.04840    0.16000    0.03383
                6        11      0.00862    0.03400    0.00728
               10        12      0.02225    0.07310    0.01563
               11        13      0.02150    0.07070    0.01513
               12        14      0.07440    0.24440    0.05223
               13        14      0.05950    0.19500    0.04183
               11        15      0.02120    0.08340    0.01783
               14        16      0.01320    0.04370    0.03700
               15        16      0.04540    0.18010    0.03883
               16        17      0.01230    0.05050    0.01082
               17        18      0.01119    0.04930    0.00952
               18        19      0.02520    0.11700    0.02483
               14        18      0.01200    0.03940    0.00842
               19        20      0.01830    0.08490    0.01800
               20        21      0.02090    0.09700    0.02050
               21        22      0.03420    0.15900    0.03367
               22        23      0.01350    0.04920    0.04150
               22        24      0.01560    0.08000    0.07200
               24        26      0.03180    0.16300    0.14700
               26        27      0.01913    0.08550    0.01800
               27        28      0.02370    0.09430    0.01983
                7        29      0.00431    0.05040    0.42833
               25        29      0.00799    0.08600    0.75667
               16        30      0.04740    0.15630    0.03325
               28        30      0.01080    0.03310    0.00692
               22        31      0.03170    0.11530    0.09775
               30        31      0.02980    0.09850    0.02092
               26        31      0.02290    0.07550    0.01605
               14        32      0.03800    0.12440    0.02662
               18        33      0.07520    0.24700    0.05267
               34        35      0.00224    0.01020    0.00223
               34        36      0.01100    0.04970    0.01098
               32        36      0.04150    0.14200    0.03050
               33        35      0.00871    0.02680    0.00473
               33        36      0.00256    0.00940    0.00820
               36        38      0.03210    0.10600    0.02250
               36        39      0.05930    0.16800    0.03500
               29        37      0.00464    0.05400    0.35167
               38        39      0.01840    0.06050    0.01293
               39        40      0.01450    0.04870    0.01018
               39        41      0.05550    0.18300    0.03883
               40        41      0.04100    0.13500    0.02867
               42        43      0.06080    0.24540    0.05057
               33        42      0.04130    0.16810    0.03522
               43        44      0.02240    0.09010    0.01867
               44        45      0.04000    0.13560    0.02767
               45        46      0.03800    0.12700    0.02633
               45        47      0.06010    0.18900    0.03933
               46        48      0.01910    0.06250    0.01337
               41        48      0.07150    0.32300    0.07167
               41        48      0.07150    0.32300    0.07167
               44        48      0.06840    0.18600    0.03700
               47        48      0.01790    0.05050    0.01048
               48        49      0.02670    0.07520    0.01562
               48        50      0.04860    0.13700    0.02850
               50        51      0.02030    0.05880    0.01163
               51        52      0.04050    0.16350    0.03382
               52        53      0.02630    0.12200    0.02583
               48        53      0.07300    0.28900    0.06150
               48        53      0.08690    0.29100    0.06083
               53        54      0.01690    0.07070    0.01683
               53        55      0.00275    0.00955    0.00610
               54        55      0.00488    0.01510    0.00312
               55        56      0.03430    0.09660    0.02017
               49        56      0.04740    0.13400    0.02767
               55        57      0.03430    0.09660    0.02017
               50        57      0.02550    0.07190    0.01490
               53        58      0.05030    0.22930    0.04983
               55        58      0.08250    0.25100    0.04742
               55        58      0.08030    0.23900    0.04467
               54        58      0.04739    0.21580    0.04705
               58        59      0.03170    0.14500    0.03133
               58        60      0.03280    0.15000    0.03233
               59        60      0.00264    0.01350    0.01213
               59        61      0.01230    0.05610    0.01223
               60        61      0.00824    0.03760    0.00817
               62        63      0.00172    0.02000    0.18000
               37        64      0.00901    0.09860    0.87167
               63        64      0.00269    0.03020    0.31667
               48        65      0.01800    0.09190    0.02067
               48        65      0.01800    0.09190    0.02067
               61        65      0.04820    0.21800    0.04817
               61        66      0.02580    0.11700    0.02583
               65        66      0.02240    0.10150    0.02235
               46        68      0.08440    0.27780    0.05910
               48        68      0.09850    0.32400    0.06900
               68        69      0.03000    0.12700    0.10167
               23        69      0.00221    0.41150    0.08498
               69        70      0.00882    0.03550    0.00732
               23        71      0.04880    0.19600    0.04067
               70        71      0.04460    0.18000    0.03703
               70        72      0.00866    0.04540    0.00982
               69        73      0.04010    0.13230    0.02807
               69        74      0.04280    0.14100    0.03000
               68        74      0.04050    0.12200    0.10333
               73        74      0.01230    0.04060    0.00862
               75        76      0.04440    0.14800    0.03067
               68        76      0.03090    0.10100    0.08650
               74        76      0.06010    0.19990    0.04148
               76        77      0.00376    0.01240    0.01053
               77        78      0.00546    0.02440    0.00540
               76        79      0.01700    0.04850    0.03933
               76        79      0.02940    0.10500    0.01900
               78        79      0.01560    0.07040    0.01558
               76        81      0.02980    0.08530    0.06812
               81        82      0.01120    0.03665    0.03163
               82        83      0.06250    0.13200    0.02150
               82        84      0.04300    0.14800    0.02900
               83        84      0.03020    0.06410    0.01028
               84        85      0.03500    0.12300    0.02300
               84        87      0.02000    0.10200    0.02300
               84        88      0.02390    0.17300    0.03917
               87        88      0.01390    0.07120    0.01612
               88        89      0.05180    0.18800    0.04400
               88        89      0.02380    0.09970    0.08833
               89        90      0.02540    0.08360    0.01783
               88        91      0.00990    0.05050    0.04567
               88        91      0.03930    0.15810    0.03450
               90        91      0.03870    0.12720    0.02723
               91        92      0.02580    0.08480    0.01817
               91        93      0.04810    0.15800    0.03383
               92        93      0.02230    0.07320    0.01563
               93        94      0.01320    0.04340    0.00925
               79        95      0.03560    0.18200    0.04117
               81        95      0.01620    0.05300    0.04533
               93        95      0.02690    0.08690    0.01917
               79        96      0.01830    0.09340    0.02117
               79        97      0.02380    0.10800    0.02383
               79        98      0.04540    0.20600    0.04550
               91        99      0.06480    0.29500    0.03933
               93        99      0.01780    0.05800    0.05033
               94        95      0.01710    0.05470    0.01228
               95        96      0.01730    0.08850    0.02000
               97        99      0.03970    0.17900    0.03967
               98        99      0.01800    0.08130    0.01800
               99       100      0.02770    0.12620    0.02733
               91       101      0.01230    0.05590    0.01220
              100       101      0.02460    0.11200    0.02450
               99       102      0.01600    0.05250    0.04467
               99       103      0.04510    0.20400    0.04508
              102       103      0.04660    0.15840    0.03392
              102       104      0.05350    0.16250    0.03400
               99       105      0.06050    0.22900    0.05167
              103       104      0.00994    0.03780    0.00822
              104       105      0.01400    0.05470    0.01195
              104       106      0.05300    0.18300    0.03933
              104       107      0.02610    0.07030    0.01537
              105       106      0.05300    0.18300    0.03933
              107       108      0.01050    0.02880    0.00633
              102       109      0.03906    0.18130    0.03842
              108       109      0.02780    0.07620    0.01683
              109       110      0.02200    0.07550    0.01667
              109       111      0.02470    0.06400    0.05167
               16       112      0.00913    0.03010    0.00640
               31       112      0.06150    0.20300    0.04317
               31       113      0.01350    0.06120    0.01357
               26       114      0.01640    0.07410    0.01643
              113       114      0.00230    0.01040    0.00230
               11       116      0.03290    0.14000    0.02983
               74       117      0.01450    0.04810    0.00998
               75       117      0.01640    0.05440    0.01130
                7         4      0.00000    0.02670    0.00000
               25        24      0.00000    0.03820    0.00000
               29        16      0.00000    0.03880    0.00000
               37        36      0.00000    0.03750    0.00000
               62        58      0.00000    0.03860    0.00000
               63        60      0.00000    0.02680    0.00000
               64        65      0.00000    0.03700    0.00000
               64        67      0.00137    0.01596    0.63963
               67        68      0.00000    0.03700    0.00000
               80        67      0.00174    0.02012    0.81131
               80        79      0.00000    0.03700    0.00000
               86        85      0.02815    0.20693    0.04460
              115        67      0.00034    0.00405    0.16403
             ];

%%         |  at_Bus   |Bus_type  | P_Load_pu | Q_Load_pu  |LF_Voltage_pu|Nominal_U_kv |
bus_data=[
                0            2     0.51000     0.27000    0.9550      138.0
                1            1     0.20000     0.09000    1.0000      138.0
                2            1     0.39000     0.10000    1.0000      138.0
                3            2     0.39000     0.12000    0.9980      138.0
                5            2     0.52000     0.22000    0.9900      138.0
                6            1     0.19000     0.02000    1.0000      138.0
                7            2     0.28000     0.00000    1.0150      345.0
               10            1     0.70000     0.23000    1.0000      138.0
               11            2     0.47000     0.10000    0.9900      138.0
               12            1     0.34000     0.16000    1.0000      138.0
               13            1     0.14000     0.01000    1.0000      138.0
               14            2     0.90000     0.30000    0.9700      138.0
               15            1     0.25000     0.10000    1.0000      138.0
               16            1     0.11000     0.03000    1.0000      138.0
               17            2     0.60000     0.34000    0.9730      138.0
               18            2     0.45000     0.25000    0.9620      138.0
               19            1     0.18000     0.03000    1.0000      138.0
               20            1     0.14000     0.08000    1.0000      138.0
               21            1     0.10000     0.05000    1.0000      138.0
               22            1     0.07000     0.03000    1.0000      138.0
               23            2     0.13000     0.00000    0.9920      138.0
               26            2     0.71000     0.13000    0.9680      138.0
               27            1     0.17000     0.07000    1.0000      138.0
               28            1     0.24000     0.04000    1.0000      138.0
               30            2     0.43000     0.27000    0.9670      138.0
               31            2     0.59000     0.23000    0.9630      138.0
               32            1     0.23000     0.09000    1.0000      138.0
               33            2     0.59000     0.26000    0.9840      138.0
               34            1     0.33000     0.09000    1.0000      138.0
               35            2     0.31000     0.17000    0.9800      138.0
               38            1     0.27000     0.11000    1.0000      138.0
               39            2     0.66000     0.23000    0.9700      138.0
               40            1     0.37000     0.10000    1.0000      138.0
               41            2     0.96000     0.23000    0.9850      138.0
               42            1     0.18000     0.07000    1.0000      138.0
               43            1     0.16000     0.08000    1.0000      138.0
               44            1     0.53000     0.22000    1.0000      138.0
               45            2     0.28000     0.10000    1.0050      138.0
               46            1     0.34000     0.00000    1.0000      138.0
               47            1     0.20000     0.11000    1.0000      138.0
               48            2     0.87000     0.30000    1.0250      138.0
               49            1     0.17000     0.04000    1.0000      138.0
               50            1     0.17000     0.08000    1.0000      138.0
               51            1     0.18000     0.05000    1.0000      138.0
               52            1     0.23000     0.11000    1.0000      138.0
               53            2     1.13000     0.32000    0.9550      138.0
               54            2     0.63000     0.22000    0.9520      138.0
               55            2     0.84000     0.18000    0.9540      138.0
               56            1     0.12000     0.03000    1.0000      138.0
               57            1     0.12000     0.03000    1.0000      138.0
               58            2     2.77000     1.13000    0.9850      138.0
               59            1     0.78000     0.03000    1.0000      138.0
               61            2     0.77000     0.14000    0.9980      138.0
               65            2     0.39000     0.18000    1.0500      138.0
               66            1     0.28000     0.07000    1.0000      138.0
               69            2     0.66000     0.20000    0.9840      138.0
               71            2     0.12000     0.00000    0.9800      138.0
               72            2     0.06000     0.00000    0.9910      138.0
               73            2     0.68000     0.27000    0.9580      138.0
               74            1     0.47000     0.11000    1.0000      138.0
               75            2     0.68000     0.36000    0.9430      138.0
               76            2     0.61000     0.28000    1.0060      138.0
               77            1     0.71000     0.26000    1.0000      138.0
               78            1     0.39000     0.32000    1.0000      138.0
               79            2     1.30000     0.26000    1.0400      138.0
               81            1     0.54000     0.27000    1.0000      138.0
               82            1     0.20000     0.10000    1.0000      138.0
               83            1     0.11000     0.07000    1.0000      138.0
               84            2     0.24000     0.15000    0.9850      138.0
               85            1     0.21000     0.10000    1.0000      138.0
               87            1     0.48000     0.10000    1.0000      138.0
               89            2     1.63000     0.42000    0.9850      138.0
               90            2     0.10000     0.00000    0.9800      138.0
               91            2     0.65000     0.10000    0.9900      138.0
               92            1     0.12000     0.07000    1.0000      138.0
               93            1     0.30000     0.16000    1.0000      138.0
               94            1     0.42000     0.31000    1.0000      138.0
               95            1     0.38000     0.15000    1.0000      138.0
               96            1     0.15000     0.09000    1.0000      138.0
               97            1     0.34000     0.08000    1.0000      138.0
               98            2     0.42000     0.00000    1.0100      138.0
               99            2     0.37000     0.18000    1.0170      138.0
              100            1     0.22000     0.15000    1.0000      138.0
              101            1     0.05000     0.03000    1.0000      138.0
              102            2     0.23000     0.16000    1.0100      138.0
              103            2     0.38000     0.25000    0.9710      138.0
              104            2     0.31000     0.26000    0.9650      138.0
              105            1     0.43000     0.16000    1.0000      138.0
              106            2     0.50000     0.12000    0.9520      138.0
              107            1     0.02000     0.01000    1.0000      138.0
              108            1     0.08000     0.03000    1.0000      138.0
              109            2     0.39000     0.30000    0.9730      138.0
              111            2     0.68000     0.13000    0.9750      138.0
              112            2     0.06000     0.00000    0.9930      138.0
              113            1     0.08000     0.03000    1.0000      138.0
              114            1     0.22000     0.07000    1.0000      138.0
              115            2     1.84000     0.00000    1.0050      345.0
              116            1     0.20000     0.08000    1.0000      138.0
              117            1     0.33000     0.15000    1.0000      138.0
             ];

      %buses with 0 load demand are not listed here
%%           |  at_Bus   | Bus_type  | Voltage_pu    |P_gen_pu   | Q_gen_pu   |Sub-transient_Xd_pu|
gen_data=[
               68     3       1.0350     0.000000   0.00000     0.25
                0     2       0.9550     0.000000   0.00000     0.25
                3     2       0.9980     0.000000   0.00000     0.25
                5     2       0.9900     0.000000   0.00000     0.25
                7     2       1.0150     0.000000   0.00000     0.25
                9     2       1.0500     4.500000   0.00000     0.25
               11     2       0.9900     0.850000   0.00000     0.25
               14     2       0.9700     0.000000   0.00000     0.25
               17     2       0.9730     0.000000   0.00000     0.25
               18     2       0.9620     0.000000   0.00000     0.25
               23     2       0.9920     0.000000   0.00000     0.25
               24     2       1.0500     2.200000   0.00000     0.25
               25     2       1.0150     3.140000   0.00000     0.25
               26     2       0.9680     0.000000   0.00000     0.25
               30     2       0.9670     0.070000   0.00000     0.25
               31     2       0.9630     0.000000   0.00000     0.25
               33     2       0.9840     0.000000   0.00000     0.25
               35     2       0.9800     0.000000   0.00000     0.25
               39     2       0.9700     0.000000   0.00000     0.25
               41     2       0.9850     0.000000   0.00000     0.25
               45     2       1.0050     0.190000   0.00000     0.25
               48     2       1.0250     2.040000   0.00000     0.25
               53     2       0.9550     0.480000   0.00000     0.25
               54     2       0.9520     0.000000   0.00000     0.25
               55     2       0.9540     0.000000   0.00000     0.25
               58     2       0.9850     1.550000   0.00000     0.25
               60     2       0.9950     1.600000   0.00000     0.25
               61     2       0.9980     0.000000   0.00000     0.25
               64     2       1.0050     3.910000   0.00000     0.25
               65     2       1.0500     3.920000   0.00000     0.25
               69     2       0.9840     0.000000   0.00000     0.25
               71     2       0.9800     0.000000   0.00000     0.25
               72     2       0.9910     0.000000   0.00000     0.25
               73     2       0.9580     0.000000   0.00000     0.25
               75     2       0.9430     0.000000   0.00000     0.25
               76     2       1.0060     0.000000   0.00000     0.25
               79     2       1.0400     4.770000   0.00000     0.25
               84     2       0.9850     0.000000   0.00000     0.25
               86     2       1.0150     0.040000   0.00000     0.25
               88     2       1.0050     6.070000   0.00000     0.25
               89     2       0.9850     0.000000   0.00000     0.25
               90     2       0.9800     0.000000   0.00000     0.25
               91     2       0.9900     0.000000   0.00000     0.25
               98     2       1.0100     0.000000   0.00000     0.25
               99     2       1.0170     2.520000   0.00000     0.25
              102     2       1.0100     0.400000   0.00000     0.25
              103     2       0.9710     0.000000   0.00000     0.25
              104     2       0.9650     0.000000   0.00000     0.25
              106     2       0.9520     0.000000   0.00000     0.25
              109     2       0.9730     0.000000   0.00000     0.25
              110     2       0.9800     0.360000   0.00000     0.25
              111     2       0.9750     0.000000   0.00000     0.25
              112     2       0.9930     0.000000   0.00000     0.25
              115     2       1.0050     0.000000   0.00000     0.25
             ];
